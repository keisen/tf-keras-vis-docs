

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Scores &mdash; tf-keras-vis v0.7.2 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Functions" href="tf_keras_vis.utils.html" />
    <link rel="prev" title="Model Modifiers" href="tf_keras_vis.utils.model_modifiers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> tf-keras-vis
          

          
          </a>

          
            
            
              <div class="version">
                0.7.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">HOME</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick-start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tf_keras_vis.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tf_keras_vis.html#feature-visualization">Feature Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tf_keras_vis.html#attentions">Attentions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tf_keras_vis.html#utilities">Utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tf_keras_vis.utils.model_modifiers.html">Model Modifiers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Scores</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#categorical-classification-model">Categorical classification model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#binary-classification-task">Binary classification task</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regression-task">Regression task</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tf_keras_vis.utils.html">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tf_keras_vis.html#model-visualization-class">Model Visualization Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">LICENSE</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tf-keras-vis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="tf_keras_vis.html">API</a> &raquo;</li>
        
      <li>Scores</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="scores">
<h1>Scores<a class="headerlink" href="#scores" title="Permalink to this headline">¶</a></h1>
<p>The Scores are used to specify somethings you want to visualized with Saliency, X-CAMs and ActivationMaximization.
Here, we will introduce the fundamental score usage with the models below.</p>
<ul class="simple">
<li><p>Categorical classification model</p></li>
<li><p>Binary classification model</p></li>
<li><p>Regression model</p></li>
</ul>
<p>If you want just to see the API specification, please skip to
<a class="reference external" href="tf_keras_vis.utils.scores.html#module-tf_keras_vis.utils.scores">Classes section</a>.</p>
<div class="section" id="categorical-classification-model">
<h2>Categorical classification model<a class="headerlink" href="#categorical-classification-model" title="Permalink to this headline">¶</a></h2>
<p>We expect the output shape of the categorical classification model is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">num_of_classes)</span></code>. That’s, <code class="docutils literal notranslate"><span class="pre">softmax</span></code> activation function is applied to the output layer of the model.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">output</span></code> variable below is assigned model output value. The code snippet below means that it will return the values corresponding to the 20th of categories.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span> <span class="c1"># output shape is (batch_size, num_of_classes)</span>
   <span class="k">return</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<p>The function below means the same as above. When you don’t need to implement additional code to process output value, we recommend you to utilize the <a class="reference external" href="tf_keras_vis.utils.scores.html#module-tf_keras_vis.utils.scores.CategoricalScore">CategoricalScore</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tf_keras_vis.utils.scores</span> <span class="kn">import</span> <span class="n">CategoricalScore</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">CategoricalScore</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to visualize corresponding to multiple various categories, you can define as follows. The code snippet below means that it will return the three values for the 20th, the 48th and the No.123rd of categories respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span> <span class="c1"># output shape is (batch_size, num_of_classes)</span>
   <span class="k">return</span> <span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">48</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that the length of the values returned by the score function MUST be identical to <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> (the number of samples).</p>
</div>
<p>Of course, you can also use <a class="reference external" href="tf_keras_vis.utils.scores.html#module-tf_keras_vis.utils.scores.CategoricalScore">CategoricalScore</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tf_keras_vis.utils.scores</span> <span class="kn">import</span> <span class="n">CategoricalScore</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">CategoricalScore</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="binary-classification-task">
<h2>Binary classification task<a class="headerlink" href="#binary-classification-task" title="Permalink to this headline">¶</a></h2>
<p>We expect the output shape of the binary classification model is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">1)</span></code> and the output value range is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>. That’s, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code> activation function is applied to the output layer of the model.</p>
<p>In categorical classification, the score functions just return the values corresponding to somethings you want to visualize. However, in binary classification, you need to be aware of whether the value you want to visualize is 0.0 or 1.0 (False or True).</p>
<div class="section" id="true">
<h3>1.0 (True)<a class="headerlink" href="#true" title="Permalink to this headline">¶</a></h3>
<p>Like the categorical classification, it just returns the value as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span> <span class="c1"># output shape is (batch_size, 1)</span>
   <span class="k">return</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="false">
<h3>0.0 (False)<a class="headerlink" href="#false" title="Permalink to this headline">¶</a></h3>
<p>The model output value smaller, the score value should be larger, so you need to multiply by <code class="docutils literal notranslate"><span class="pre">-1.0</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span> <span class="c1"># output shape is (batch_size, 1)</span>
   <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="utilizing-binaryscore-class">
<h3>Utilizing BinaryScore class<a class="headerlink" href="#utilizing-binaryscore-class" title="Permalink to this headline">¶</a></h3>
<p>Of course, we recommend you to utilize BinaryScore class as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tf_keras_vis.utils.scores</span> <span class="kn">import</span> <span class="n">BinaryScore</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">BinaryScore</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># or BinaryScore(False) </span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tf_keras_vis.utils.scores</span> <span class="kn">import</span> <span class="n">BinaryScore</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">BinaryScore</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># or BinaryScore(True) </span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="regression-task">
<h2>Regression task<a class="headerlink" href="#regression-task" title="Permalink to this headline">¶</a></h2>
<p>We expect the output shape of the regression model is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">1)</span></code> like binary classification, however the output value range is no limitation. That’s, <code class="docutils literal notranslate"><span class="pre">linear</span></code> activation function is applied to the output layer of the model.</p>
<p>In regression task, we need to consider how what we want to visualize contributes to the model output.
Here, we introduce a simple way each for three situations below we want to visualize.</p>
<ol class="simple">
<li><p>Increase the output value</p></li>
<li><p>Decrease the output value</p></li>
<li><p>Maintain the output value at …</p></li>
</ol>
<div class="section" id="increase-the-output-value">
<h3>1. Increase the output value<a class="headerlink" href="#increase-the-output-value" title="Permalink to this headline">¶</a></h3>
<p>It just returns the value like the categorical classification.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="decrease-the-output-value">
<h3>2. Decrease the output value<a class="headerlink" href="#decrease-the-output-value" title="Permalink to this headline">¶</a></h3>
<p>The model output value smaller, the score value should be larger,
so you need to multiply by <code class="docutils literal notranslate"><span class="pre">-1.0</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="maintain-the-output-value-at">
<h3>3. Maintain the output value at …<a class="headerlink" href="#maintain-the-output-value-at" title="Permalink to this headline">¶</a></h3>
<p>The model output value closer to the target value, the score value should be larger, so you need to calculate <code class="docutils literal notranslate"><span class="pre">abs(1.0</span> <span class="pre">/</span> <span class="pre">(target_value</span> <span class="pre">-</span> <span class="pre">model_output_value))</span></code>.
For example, suppose the target value is 0.0, the score function should be as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">score_function</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">epsilon</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tf_keras_vis.utils.html" class="btn btn-neutral float-right" title="Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="tf_keras_vis.utils.model_modifiers.html" class="btn btn-neutral float-left" title="Model Modifiers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, keisen(Yasuhiro Kubota).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>